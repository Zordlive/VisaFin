{% extends "admin/index.html" %}
{% load i18n static %}

{% block content %}
{{ block.super }}

{# Widget des actions rÃ©centes des utilisateurs #}
{% include "admin/user_recent_actions.html" %}

{# Statistiques rapides #}
<div class="module" style="margin-bottom: 20px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
    <h2 style="margin: 0 0 15px 0; padding-bottom: 10px; border-bottom: 3px solid #417690; color: #417690;">
        ğŸ“Š Statistiques rapides
    </h2>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        {# DÃ©pÃ´ts en attente #}
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 8px; color: white;">
            <div style="font-size: 32px; font-weight: bold; margin-bottom: 5px;">
                {{ dashboard_stats.deposits_pending }}
            </div>
            <div style="font-size: 14px; opacity: 0.9;">
                DÃ©pÃ´ts en attente
            </div>
            <a href="{% url 'admin:api_deposit_changelist' %}?status__exact=pending" style="display: inline-block; margin-top: 10px; padding: 5px 10px; background: rgba(255,255,255,0.2); color: white; text-decoration: none; border-radius: 4px; font-size: 12px;">
                Voir tous â†’
            </a>
        </div>
        
        {# Retraits en attente #}
        <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 20px; border-radius: 8px; color: white;">
            <div style="font-size: 32px; font-weight: bold; margin-bottom: 5px;">
                {{ dashboard_stats.withdrawals_pending }}
            </div>
            <div style="font-size: 14px; opacity: 0.9;">
                Retraits en attente
            </div>
            <a href="{% url 'admin:api_withdrawal_changelist' %}?status__exact=pending" style="display: inline-block; margin-top: 10px; padding: 5px 10px; background: rgba(255,255,255,0.2); color: white; text-decoration: none; border-radius: 4px; font-size: 12px;">
                GÃ©rer â†’
            </a>
        </div>
        
        {# Retraits en traitement #}
        <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 20px; border-radius: 8px; color: white;">
            <div style="font-size: 32px; font-weight: bold; margin-bottom: 5px;">
                {{ dashboard_stats.withdrawals_processing }}
            </div>
            <div style="font-size: 14px; opacity: 0.9;">
                Retraits en traitement
            </div>
            <a href="{% url 'admin:api_withdrawal_changelist' %}?status__exact=processing" style="display: inline-block; margin-top: 10px; padding: 5px 10px; background: rgba(255,255,255,0.2); color: white; text-decoration: none; border-radius: 4px; font-size: 12px;">
                GÃ©rer â†’
            </a>
        </div>
        
        {# Nouveaux utilisateurs aujourd'hui #}
        <div style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); padding: 20px; border-radius: 8px; color: white;">
            <div style="font-size: 32px; font-weight: bold; margin-bottom: 5px;">
                {{ dashboard_stats.users_today }}
            </div>
            <div style="font-size: 14px; opacity: 0.9;">
                Nouveaux utilisateurs (24h)
            </div>
            <a href="{% url 'admin:auth_user_changelist' %}" style="display: inline-block; margin-top: 10px; padding: 5px 10px; background: rgba(255,255,255,0.2); color: white; text-decoration: none; border-radius: 4px; font-size: 12px;">
                Voir tous â†’
            </a>
        </div>
        
        {# Total dÃ©pÃ´ts cette semaine #}
        <div style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); padding: 20px; border-radius: 8px; color: white;">
            <div style="font-size: 32px; font-weight: bold; margin-bottom: 5px;">
                {{ dashboard_stats.deposits_week }}
            </div>
            <div style="font-size: 14px; opacity: 0.9;">
                DÃ©pÃ´ts cette semaine
            </div>
            <a href="{% url 'admin:api_deposit_changelist' %}" style="display: inline-block; margin-top: 10px; padding: 5px 10px; background: rgba(255,255,255,0.2); color: white; text-decoration: none; border-radius: 4px; font-size: 12px;">
                Voir tous â†’
            </a>
        </div>
        
        {# Total retraits cette semaine #}
        <div style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); padding: 20px; border-radius: 8px; color: #333;">
            <div style="font-size: 32px; font-weight: bold; margin-bottom: 5px;">
                {{ dashboard_stats.withdrawals_week }}
            </div>
            <div style="font-size: 14px; opacity: 0.8;">
                Retraits cette semaine
            </div>
            <a href="{% url 'admin:api_withdrawal_changelist' %}" style="display: inline-block; margin-top: 10px; padding: 5px 10px; background: rgba(0,0,0,0.1); color: #333; text-decoration: none; border-radius: 4px; font-size: 12px;">
                Voir tous â†’
            </a>
        </div>
        
        {# Utilisateurs actifs #}
        <div style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); padding: 20px; border-radius: 8px; color: #333;">
            <div style="font-size: 32px; font-weight: bold; margin-bottom: 5px;">
                {{ dashboard_stats.users_active }}
            </div>
            <div style="font-size: 14px; opacity: 0.8;">
                Utilisateurs actifs
            </div>
            <a href="{% url 'admin:auth_user_changelist' %}?is_active__exact=1" style="display: inline-block; margin-top: 10px; padding: 5px 10px; background: rgba(0,0,0,0.1); color: #333; text-decoration: none; border-radius: 4px; font-size: 12px;">
                Voir tous â†’
            </a>
        </div>
        
        {# Total utilisateurs #}
        <div style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); padding: 20px; border-radius: 8px; color: #333;">
            <div style="font-size: 32px; font-weight: bold; margin-bottom: 5px;">
                {{ dashboard_stats.users_total }}
            </div>
            <div style="font-size: 14px; opacity: 0.8;">
                Total utilisateurs
            </div>
            <a href="{% url 'admin:auth_user_changelist' %}" style="display: inline-block; margin-top: 10px; padding: 5px 10px; background: rgba(0,0,0,0.1); color: #333; text-decoration: none; border-radius: 4px; font-size: 12px;">
                GÃ©rer â†’
            </a>
        </div>
    </div>
</div>

{# Actions urgentes #}
{% if pending_actions.deposits_pending or pending_actions.withdrawals_pending or pending_actions.notifications_unread %}
<div class="module" style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
    <h3 style="margin: 0 0 15px 0; color: #856404; display: flex; align-items: center;">
        <span style="font-size: 24px; margin-right: 10px;">âš ï¸</span>
        Actions nÃ©cessitant votre attention
    </h3>
    
    <ul style="list-style: none; padding: 0; margin: 0;">
        {% if pending_actions.deposits_pending %}
        <li style="padding: 10px 0; border-bottom: 1px solid #ffeeba;">
            <strong style="color: #856404;">{{ pending_actions.deposits_pending }}</strong> dÃ©pÃ´t(s) en attente de validation
            <a href="{% url 'admin:api_deposit_changelist' %}?status__exact=pending" style="margin-left: 10px; color: #856404; font-weight: bold;">
                Traiter maintenant â†’
            </a>
        </li>
        {% endif %}
        
        {% if pending_actions.withdrawals_pending %}
        <li style="padding: 10px 0; border-bottom: 1px solid #ffeeba;">
            <strong style="color: #856404;">{{ pending_actions.withdrawals_pending }}</strong> demande(s) de retrait Ã  traiter
            <a href="{% url 'admin:api_withdrawal_changelist' %}?status__in=pending,processing" style="margin-left: 10px; color: #856404; font-weight: bold;">
                Traiter maintenant â†’
            </a>
        </li>
        {% endif %}
        
        {% if pending_actions.notifications_unread %}
        <li style="padding: 10px 0;">
            <strong style="color: #856404;">{{ pending_actions.notifications_unread }}</strong> notification(s) non lue(s)
            <a href="{% url 'admin:api_adminnotification_changelist' %}?is_read__exact=0" style="margin-left: 10px; color: #856404; font-weight: bold;">
                Voir â†’
            </a>
        </li>
        {% endif %}
    </ul>
</div>
{% endif %}

<style>
@media (max-width: 768px) {
    div[style*="grid-template-columns"] {
        grid-template-columns: 1fr !important;
    }
}
</style>
{% endblock %}
